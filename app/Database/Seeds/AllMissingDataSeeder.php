<?php

namespace App\Database\Seeds;

use CodeIgniter\Database\Seeder;
use Ramsey\Uuid\Uuid;

/**
 * Seeder UNIFICADO para insertar TODOS los datos faltantes del archivo Excel RESERVAS ONLINE.xlsx
 *
 * Este seeder combina:
 * - MissingDataSeeder (ciudades con IDs fijos)
 * - ExcelMissingDataSeeder (ciudades adicionales por nombre de county)
 *
 * SEGURO PARA PRODUCCIÃ“N:
 * - Verifica existencia antes de insertar
 * - Usa try-catch para manejar errores sin detener la ejecuciÃ³n
 * - Puede ejecutarse mÃºltiples veces sin duplicar datos
 * - ContinÃºa insertando aunque algunos registros fallen
 *
 * Ejecutar con: php spark db:seed AllMissingDataSeeder
 */
class AllMissingDataSeeder extends Seeder
{
    private int $errors = 0;
    private int $skipped = 0;

    public function run()
    {
        echo "ğŸš€ Iniciando AllMissingDataSeeder (Seeder Unificado)...\n\n";

        // PARTE 1: Ciudades con IDs fijos (del MissingDataSeeder original)
        echo "ğŸ“ PARTE 1: Insertando ciudades con IDs fijos...\n";
        $citiesFixed = $this->insertCitiesWithFixedIds();
        echo "âœ… Ciudades (IDs fijos) insertadas: {$citiesFixed}\n\n";

        // PARTE 2: Ciudades adicionales por nombre de county (del ExcelMissingDataSeeder)
        echo "ğŸ“ PARTE 2: Insertando ciudades adicionales por county...\n";
        $citiesAdditional = $this->insertCitiesByCountyName();
        echo "âœ… Ciudades adicionales insertadas: {$citiesAdditional}\n\n";

        // PARTE 3: Todos los ZipCodes
        echo "ğŸ“ PARTE 3: Insertando zipcodes...\n";
        $zipcodesInserted = $this->insertAllZipCodes();
        echo "âœ… ZipCodes insertados: {$zipcodesInserted}\n\n";

        echo "ğŸ‰ AllMissingDataSeeder completado!\n";
        echo "   Total ciudades nuevas: " . ($citiesFixed + $citiesAdditional) . "\n";
        echo "   Total zipcodes nuevos: {$zipcodesInserted}\n";

        if ($this->skipped > 0) {
            echo "   â­ï¸ Registros omitidos (ya existÃ­an): {$this->skipped}\n";
        }
        if ($this->errors > 0) {
            echo "   âš ï¸ Errores encontrados (continuÃ³ la ejecuciÃ³n): {$this->errors}\n";
        }
    }

    /**
     * Verifica si un registro existe en una tabla
     */
    private function recordExists(string $table, array $conditions): bool
    {
        try {
            $query = $this->db->table($table);
            foreach ($conditions as $field => $value) {
                $query->where($field, $value);
            }
            return $query->countAllResults() > 0;
        } catch (\Exception $e) {
            return false;
        }
    }

    /**
     * Inserta un registro de forma segura, manejando errores
     */
    private function safeInsert(string $table, array $data, string $identifier = ''): bool
    {
        try {
            $this->db->table($table)->insert($data);
            return true;
        } catch (\Exception $e) {
            $this->errors++;
            // Solo mostrar errores que no sean de duplicados
            if (strpos($e->getMessage(), 'Duplicate') === false) {
                echo "   âš ï¸ Error insertando {$identifier}: " . substr($e->getMessage(), 0, 100) . "\n";
            }
            return false;
        }
    }

    /**
     * PARTE 1: Ciudades con IDs fijos (compatibilidad con MissingDataSeeder)
     */
    private function insertCitiesWithFixedIds(): int
    {
        $cities = [
            // ========================
            // NEW YORK - Counties existentes
            // ========================
            ['id' => '20000000-aaaa-bbbb-cccc-000000000062', 'name' => 'Rockland', 'county_id' => 'aa10d1e2-034f-4521-789a-bcdef0123456'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000063', 'name' => 'Putnam', 'county_id' => 'bb21e2f3-1450-4632-89ab-cdef01234567'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000064', 'name' => 'Orange County', 'county_id' => 'cc32f304-2561-4743-9abc-def012345678'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000065', 'name' => 'Dutchess', 'county_id' => 'dd430415-3672-4854-abcd-ef0123456789'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000066', 'name' => 'Nassau', 'county_id' => 'ee540526-4783-4965-bcde-f0123456789a'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000067', 'name' => 'Suffolk', 'county_id' => 'ff650637-5894-4a76-cdef-0123456789ab'],

            // ========================
            // NEW JERSEY
            // ========================
            ['id' => '20000000-aaaa-bbbb-cccc-000000000068', 'name' => 'Bergen County', 'county_id' => '1010aa11-bb22-cc33-dd44-ee5566778899'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000069', 'name' => 'Essex County', 'county_id' => '2020bb22-cc33-dd44-ee55-66778899aabb'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000070', 'name' => 'Hudson County', 'county_id' => '3030cc33-dd44-ee55-6677-8899aabbccdd'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000071', 'name' => 'Middlesex County', 'county_id' => '4040dd44-ee55-6677-8899-aabbccddeeff'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000072', 'name' => 'Passaic County', 'county_id' => '6060ff66-7788-99aa-bbcc-ddeeff001122'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000073', 'name' => 'Union County', 'county_id' => '7070aa77-8899-aabb-ccdd-eeff00112233'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000074', 'name' => 'Burlington County', 'county_id' => '8080bb88-99aa-bbcc-ddee-ff0011223344'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000075', 'name' => 'Camden County', 'county_id' => '9090cc99-aabb-ccdd-eeff-001122334455'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000076', 'name' => 'Hunterdon County', 'county_id' => '1111ddaa-bbcc-ddee-ff00-112233445566'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000077', 'name' => 'Mercer County', 'county_id' => '1212eebb-ccdd-eeff-0011-223344556677'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000078', 'name' => 'Morris County', 'county_id' => '1313ffcc-ddee-ff00-1122-334455667788'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000079', 'name' => 'Monmouth County', 'county_id' => '1414aadd-eeff-0011-2233-445566778899'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000080', 'name' => 'Ocean County', 'county_id' => '1515bbee-ff00-1122-3344-5566778899aa'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000081', 'name' => 'Somerset County', 'county_id' => '1616ccff-0011-2233-4455-66778899aabb'],

            // ========================
            // LOS ANGELES
            // ========================
            ['id' => '20000000-aaaa-bbbb-cccc-000000000082', 'name' => 'Los Angeles', 'county_id' => '1717ddee-1122-3344-5566-778899aabbcc'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000083', 'name' => 'Orange County', 'county_id' => '1818eeff-2233-4455-6677-8899aabbccdd'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000084', 'name' => 'Riverside', 'county_id' => '1919ffaa-3344-5566-7788-99aabbccdde0'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000085', 'name' => 'Ventura', 'county_id' => '2020aabb-4455-6677-8899-aabbccddeeff'],

            // ========================
            // WASHINGTON DC
            // ========================
            ['id' => '20000000-aaaa-bbbb-cccc-000000000086', 'name' => 'Washington DC', 'county_id' => '2121bbcc-5566-7788-99aa-bbccddeeff00'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000087', 'name' => 'Montgomery County', 'county_id' => '2525ffaa-99aa-bbcc-ddee-ff0011223344'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000088', 'name' => "Prince George's County", 'county_id' => '2525ffaa-99aa-bbcc-ddee-ff0011223344'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000089', 'name' => 'Howard County', 'county_id' => '2525ffaa-99aa-bbcc-ddee-ff0011223344'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000090', 'name' => 'Anne Arundel County', 'county_id' => '2525ffaa-99aa-bbcc-ddee-ff0011223344'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000091', 'name' => 'Charles County', 'county_id' => '2525ffaa-99aa-bbcc-ddee-ff0011223344'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000092', 'name' => 'Arlington County', 'county_id' => '2626aabb-aabb-ccdd-eeff-001122334455'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000093', 'name' => 'Fairfax County', 'county_id' => '2626aabb-aabb-ccdd-eeff-001122334455'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000094', 'name' => 'Loudoun County', 'county_id' => '2626aabb-aabb-ccdd-eeff-001122334455'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000095', 'name' => 'Alexandria, VA', 'county_id' => '2626aabb-aabb-ccdd-eeff-001122334455'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000096', 'name' => 'Falls Church, VA', 'county_id' => '2626aabb-aabb-ccdd-eeff-001122334455'],

            // ========================
            // CHICAGO
            // ========================
            ['id' => '20000000-aaaa-bbbb-cccc-000000000097', 'name' => 'Chicago, IL', 'county_id' => '3131bbcc-4455-6677-8899-aabbccddeeff'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000098', 'name' => 'Arlington Heights', 'county_id' => '3131bbcc-4455-6677-8899-aabbccddeeff'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000099', 'name' => 'Elk Grove Village', 'county_id' => '3131bbcc-4455-6677-8899-aabbccddeeff'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000100', 'name' => 'Des Plaines', 'county_id' => '3131bbcc-4455-6677-8899-aabbccddeeff'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000101', 'name' => 'Mount Prospect', 'county_id' => '3131bbcc-4455-6677-8899-aabbccddeeff'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000102', 'name' => 'Palatine', 'county_id' => '3131bbcc-4455-6677-8899-aabbccddeeff'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000103', 'name' => 'Schaumburg', 'county_id' => '3131bbcc-4455-6677-8899-aabbccddeeff'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000104', 'name' => 'Oakbrook Terrace', 'county_id' => '3131bbcc-4455-6677-8899-aabbccddeeff'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000105', 'name' => 'Oak Park', 'county_id' => '3131bbcc-4455-6677-8899-aabbccddeeff'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000106', 'name' => 'Cicero', 'county_id' => '3131bbcc-4455-6677-8899-aabbccddeeff'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000107', 'name' => 'DuPage', 'county_id' => '3232ccdd-5566-7788-99aa-bbccddeeff00'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000108', 'name' => 'Lake County', 'county_id' => '3333ddee-6677-8899-aabb-ccddeeff0011'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000109', 'name' => 'Will County', 'county_id' => '3434eeff-7788-99aa-bbcc-ddeeff001122'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000110', 'name' => 'Kendall County', 'county_id' => '3535ffaa-8899-aabb-ccdd-eeff00112233'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000111', 'name' => 'McHenry County', 'county_id' => '3636aabb-99aa-bbcc-ddee-ff0011223344'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000112', 'name' => 'Kane County', 'county_id' => '3737bbcc-aabb-ccdd-eeff-001122334455'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000113', 'name' => 'Grundy County', 'county_id' => '3838ccdd-bbcc-ddee-ff00-112233445566'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000114', 'name' => 'DeKalb County', 'county_id' => '3939ddee-ccdd-eeff-0011-223344556677'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000115', 'name' => 'Kankakee County', 'county_id' => '4040eeff-ddee-ff00-1122-334455667788'],

            // ========================
            // NASHVILLE
            // ========================
            ['id' => '20000000-aaaa-bbbb-cccc-000000000116', 'name' => 'Nashville', 'county_id' => '4141aabb-ccdd-eeff-0011-223344556677'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000117', 'name' => 'Williamson County', 'county_id' => '4242bbcc-ddee-ff00-1122-334455667788'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000118', 'name' => 'Rutherford County', 'county_id' => '4343ccdd-eeff-0011-2233-445566778899'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000119', 'name' => 'Wilson County', 'county_id' => '4444ddee-ff00-1122-3344-5566778899aa'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000120', 'name' => 'Sumner County', 'county_id' => '4545eeff-0011-2233-4455-66778899aabb'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000121', 'name' => 'Cheatham County', 'county_id' => '4646ffaa-1122-3344-5566-778899aabbcc'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000122', 'name' => 'Robertson County', 'county_id' => '4747aabb-2233-4455-6677-8899aabbccdd'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000123', 'name' => 'Dickson County', 'county_id' => '4848bbcc-3344-5566-7788-99aabbccdde0'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000124', 'name' => 'Maury County', 'county_id' => '4949ccdd-4455-6677-8899-aabbccddeeff'],
            ['id' => '20000000-aaaa-bbbb-cccc-000000000125', 'name' => 'Trousdale County', 'county_id' => '5050ddee-5566-7788-99aa-bbccddeeff00'],
        ];

        $inserted = 0;
        foreach ($cities as $city) {
            try {
                // Verificar si la ciudad ya existe por ID o por nombre+county
                if ($this->recordExists('cities', ['id' => $city['id']])) {
                    $this->skipped++;
                    continue;
                }

                // TambiÃ©n verificar por nombre y county para evitar duplicados
                if ($this->recordExists('cities', ['name' => $city['name'], 'county_id' => $city['county_id']])) {
                    $this->skipped++;
                    continue;
                }

                // Verificar que el county exista
                if (!$this->recordExists('counties', ['id' => $city['county_id']])) {
                    continue;
                }

                if ($this->safeInsert('cities', $city, "ciudad {$city['name']}")) {
                    $inserted++;
                }
            } catch (\Exception $e) {
                $this->errors++;
                continue;
            }
        }
        return $inserted;
    }

    /**
     * PARTE 2: Ciudades adicionales buscando county por nombre
     */
    private function insertCitiesByCountyName(): int
    {
        $missingCities = [
            // NEW YORK
            ['name' => 'Westchester County', 'county_name' => 'Westchester County'],
            ['name' => 'Putnam County', 'county_name' => 'Putnam County'],
            ['name' => 'Dutchess County', 'county_name' => 'Dutchess County'],
            ['name' => 'Nassau County', 'county_name' => 'Nassau County'],
            ['name' => 'Suffolk County', 'county_name' => 'Suffolk County'],
            ['name' => 'Rockland County', 'county_name' => 'Rockland County'],

            // LOS ANGELES
            ['name' => 'Los Angeles County', 'county_name' => 'Los Angeles County'],
            ['name' => 'Orange County CA', 'county_name' => 'Orange County'],
            ['name' => 'Riverside County', 'county_name' => 'Riverside County'],
            ['name' => 'Ventura County', 'county_name' => 'Ventura County'],

            // CHICAGO
            ['name' => 'DuPage County', 'county_name' => 'DuPage County'],
            ['name' => 'Lake County IL', 'county_name' => 'Lake County'],

            // NASHVILLE
            ['name' => 'Montgomery County TN', 'county_name' => 'Davidson County'],
        ];

        $count = 0;
        foreach ($missingCities as $cityData) {
            try {
                // Verificar si la ciudad ya existe
                if ($this->recordExists('cities', ['name' => $cityData['name']])) {
                    $this->skipped++;
                    continue;
                }

                // Buscar el county por nombre
                $county = $this->db->table('counties')->where('name', $cityData['county_name'])->get()->getRow();
                if (!$county) {
                    continue;
                }

                $cityRecord = [
                    'id' => Uuid::uuid4()->toString(),
                    'name' => $cityData['name'],
                    'county_id' => $county->id,
                    'created_at' => date('Y-m-d H:i:s'),
                    'updated_at' => date('Y-m-d H:i:s'),
                ];

                if ($this->safeInsert('cities', $cityRecord, "ciudad {$cityData['name']}")) {
                    $count++;
                }
            } catch (\Exception $e) {
                $this->errors++;
                continue;
            }
        }
        return $count;
    }

    /**
     * PARTE 3: Todos los ZipCodes
     */
    private function insertAllZipCodes(): int
    {
        // ZipCodes por city_id fijo
        $zipsByFixedId = [
            // NEW YORK
            '20000000-aaaa-bbbb-cccc-000000000062' => ['10901', '10911', '10913', '10920', '10923', '10927', '10931', '10952', '10954', '10956', '10960', '10962', '10964', '10965', '10968', '10970', '10974', '10976', '10977', '10980', '10983', '10984', '10986', '10989', '10993', '10994'],
            '20000000-aaaa-bbbb-cccc-000000000063' => ['10509', '10512', '10516', '10524', '10537', '10541', '10542', '10579', '10588', '10598'],
            '20000000-aaaa-bbbb-cccc-000000000064' => ['10912', '10914', '10915', '10916', '10917', '10918', '10919', '10921', '10924', '10925', '10926', '10928', '10930', '10932', '10933', '10940', '10941', '10949', '10950', '10958', '10959', '10963', '10969', '10973', '10975', '10979', '10981', '10985', '10987', '10990', '10992', '10996', '10998', '12518', '12520', '12542', '12543', '12549', '12550', '12551', '12552', '12553', '12566', '12575', '12577', '12584', '12586'],
            '20000000-aaaa-bbbb-cccc-000000000065' => ['12501', '12506', '12507', '12508', '12510', '12512', '12514', '12522', '12524', '12527', '12531', '12533', '12537', '12538', '12540', '12545', '12546', '12564', '12567', '12569', '12570', '12571', '12572', '12574', '12578', '12580', '12581', '12582', '12583', '12585', '12590', '12592', '12594', '12601', '12603'],
            '20000000-aaaa-bbbb-cccc-000000000066' => ['11001', '11003', '11004', '11005', '11010', '11020', '11021', '11023', '11024', '11030', '11040', '11042', '11050', '11501', '11507', '11509', '11510', '11514', '11516', '11518', '11520', '11530', '11542', '11545', '11547', '11548', '11550', '11552', '11553', '11554', '11556', '11557', '11558', '11559', '11560', '11561', '11563', '11565', '11566', '11568', '11570', '11572', '11575', '11576', '11577', '11579', '11580', '11581', '11590', '11596', '11598', '11701', '11710', '11714', '11732', '11735', '11736', '11737', '11753', '11756', '11758', '11762', '11765', '11771', '11783', '11791', '11793', '11797'],
            '20000000-aaaa-bbbb-cccc-000000000067' => ['00501', '11701', '11702', '11703', '11704', '11705', '11706', '11707', '11708', '11713', '11715', '11716', '11717', '11718', '11719', '11720', '11721', '11722', '11724', '11725', '11726', '11727', '11729', '11730', '11731', '11733', '11735', '11738', '11739', '11740', '11741', '11742', '11743', '11746', '11747', '11749', '11750', '11751', '11752', '11754', '11755', '11757', '11760', '11763', '11764', '11766', '11767', '11768', '11769', '11770', '11772', '11775', '11776', '11777', '11778', '11779', '11780', '11782', '11784', '11786', '11787', '11788', '11789', '11790', '11792', '11794', '11795', '11796', '11798', '11803', '11804', '11901', '11930', '11931', '11932', '11933', '11934', '11935', '11937', '11939', '11940', '11941', '11942', '11944', '11946', '11947', '11948', '11949', '11950', '11951', '11952', '11953', '11954', '11955', '11956', '11957', '11958', '11959', '11960', '11961', '11962', '11963', '11964', '11965', '11967', '11968', '11970', '11971', '11972', '11973', '11975', '11976', '11977', '11978', '11980'],

            // NEW JERSEY
            '20000000-aaaa-bbbb-cccc-000000000068' => ['07001', '07002', '07003', '07004', '07005', '07006', '07010', '07011', '07012', '07013', '07014', '07016', '07017', '07018', '07019', '07020', '07022', '07024', '07026', '07027', '07028', '07029', '07031', '07032', '07033', '07035', '07036', '07039', '07040', '07041', '07042', '07043', '07044', '07045', '07046', '07047', '07049', '07050', '07052', '07057', '07058', '07059', '07063', '07064', '07065', '07066', '07067', '07070', '07071', '07072', '07073', '07074', '07075', '07076', '07077', '07078', '07079', '07080', '07081', '07083', '07086', '07087', '07088', '07092', '07093', '07094', '07095', '07096', '07097', '07099'],
            '20000000-aaaa-bbbb-cccc-000000000069' => ['07002', '07006', '07017', '07018', '07019', '07022', '07026', '07028', '07039', '07040', '07042', '07043', '07044', '07045', '07047', '07050', '07052', '07054', '07055', '07057', '07058', '07059', '07062', '07063', '07064', '07065', '07066', '07067', '07070', '07071', '07072', '07073', '07074', '07075', '07076', '07077', '07078', '07079', '07080', '07081', '07082', '07083', '07085', '07087', '07088', '07092', '07093', '07094', '07095', '07096', '07099'],
            '20000000-aaaa-bbbb-cccc-000000000070' => ['07002', '07006', '07010', '07011', '07020', '07022', '07024', '07029', '07032', '07039', '07047', '07050', '07051', '07052', '07093', '07302', '07303', '07304', '07305', '07306', '07307', '07308', '07310'],
            '20000000-aaaa-bbbb-cccc-000000000071' => ['07001', '07008', '07010', '07023', '07036', '07039', '07040', '07041', '07042', '07043', '07044', '07047', '07058', '07062', '07063', '07064', '07065', '07066', '07067', '07069', '07070', '07071', '07072', '07073', '07074', '07077', '07078', '07079', '07080', '07081', '07082', '07083', '07086', '07087', '07088', '07090', '07095', '07096', '07097', '07099'],
            '20000000-aaaa-bbbb-cccc-000000000072' => ['07003', '07004', '07005', '07008', '07010', '07011', '07012', '07013', '07014', '07015', '07016', '07017', '07018', '07019', '07020', '07021', '07022', '07023', '07024', '07026', '07027', '07028', '07029', '07030', '07031', '07032', '07033', '07034', '07035', '07036', '07037', '07038', '07039', '07040', '07041', '07042', '07043', '07044', '07045', '07046', '07047', '07048', '07050', '07051', '07052', '07053', '07055', '07056', '07057', '07058', '07059', '07060', '07061', '07062', '07063', '07064', '07065', '07066', '07067', '07068', '07069', '07070', '07071', '07072', '07073', '07074', '07075', '07076', '07077', '07078', '07079', '07080', '07081', '07082', '07083', '07084'],
            '20000000-aaaa-bbbb-cccc-000000000073' => ['07001', '07002', '07004', '07005', '07006', '07008', '07009', '07011', '07012', '07013', '07014', '07015', '07016', '07017', '07018', '07019', '07020', '07021', '07022', '07023', '07024', '07026', '07027', '07028', '07029', '07030', '07031', '07032', '07033', '07034', '07035', '07036', '07037', '07038', '07039', '07040', '07041', '07042', '07043', '07044', '07045', '07046', '07047', '07048', '07050', '07051', '07052', '07053', '07054', '07055', '07056', '07057', '07058', '07059', '07060', '07061', '07062', '07063', '07064', '07065', '07066', '07067', '07068', '07069', '07070', '07071', '07072', '07073', '07074', '07075', '07076', '07077', '07078', '07079', '07080', '07081', '07082', '07083', '07084', '07085'],
            '20000000-aaaa-bbbb-cccc-000000000074' => ['08010', '08011', '08015', '08016', '08020', '08022', '08023', '08025', '08029', '08030', '08031', '08034', '08035', '08036', '08037', '08041', '08046', '08048', '08052', '08053', '08054', '08055', '08057', '08059', '08060', '08062', '08063', '08065', '08066', '08068', '08069', '08073', '08075', '08077', '08078', '08080', '08081', '08082', '08083', '08084', '08086', '08088', '08091', '08092', '08093', '08094', '08097'],
            '20000000-aaaa-bbbb-cccc-000000000075' => ['08002', '08003', '08004', '08007', '08009', '08012', '08021', '08023', '08026', '08029', '08030', '08031', '08033', '08034', '08035', '08036', '08043', '08045', '08049', '08051', '08052', '08054', '08055', '08057', '08059', '08063', '08065', '08067', '08071', '08075', '08077', '08078', '08080', '08083', '08084', '08085', '08088', '08091', '08092', '08093'],
            '20000000-aaaa-bbbb-cccc-000000000076' => ['08801', '08802', '08803', '08804', '08805', '08807', '08808', '08809', '08812', '08817', '08818', '08822', '08823', '08824', '08825', '08826', '08827', '08833', '08836', '08840', '08844', '08848', '08853', '08854', '08855', '08858', '08865', '08869'],
            '20000000-aaaa-bbbb-cccc-000000000077' => ['08501', '08502', '08504', '08505', '08510', '08511', '08512', '08514', '08515', '08520', '08525', '08530', '08540', '08541', '08542', '08543', '08544', '08550', '08551', '08553', '08554', '08560', '08561', '08562', '08570', '08571', '08572', '08574'],
            '20000000-aaaa-bbbb-cccc-000000000078' => ['07801', '07803', '07804', '07806', '07810', '07820', '07821', '07822', '07823', '07825', '07826', '07827', '07828', '07830', '07832', '07834', '07836', '07837', '07838', '07840', '07843', '07844', '07845', '07846', '07847', '07848', '07849', '07852', '07853', '07856', '07857', '07860', '07866', '07868', '07869', '07870', '07871', '07874', '07876', '07878', '07879', '07885'],
            '20000000-aaaa-bbbb-cccc-000000000079' => ['07701', '07702', '07703', '07704', '07711', '07712', '07714', '07715', '07716', '07717', '07718', '07719', '07720', '07721', '07722', '07723', '07724', '07726', '07727', '07728', '07730', '07731', '07732', '07733', '07734', '07735', '07737', '07738', '07740', '07746', '07747', '07748', '07750', '07751', '07752', '07753', '07755', '07756', '07757', '07758', '07760', '07762', '07763', '07764', '07765', '07766', '07767', '07768', '07769', '07770', '07771', '07773', '07774'],
            '20000000-aaaa-bbbb-cccc-000000000080' => ['08701', '08702', '08721', '08722', '08723', '08724', '08730', '08731', '08732', '08733', '08734', '08735', '08736', '08738', '08739', '08740', '08741', '08742', '08750', '08751', '08752', '08753', '08754', '08755', '08756', '08757', '08758', '08759', '08760', '08761', '08762', '08764', '08765', '08767', '08768', '08769', '08770', '08771', '08772', '08773', '08775'],
            '20000000-aaaa-bbbb-cccc-000000000081' => ['07059', '07069', '07092', '07840', '07847', '08801', '08805', '08807', '08808', '08809', '08810', '08812', '08817', '08822', '08823', '08824', '08825', '08826', '08827', '08833', '08836', '08846', '08853', '08858', '08873', '08879', '08889'],

            // LOS ANGELES
            '20000000-aaaa-bbbb-cccc-000000000082' => ['90001', '90002', '90003', '90004', '90005', '90006', '90007', '90008', '90010', '90011', '90012', '90013', '90014', '90015', '90016', '90017', '90018', '90019', '90020', '90021', '90023', '90024', '90025', '90026', '90027', '90028', '90029', '90031', '90032', '90033', '90034', '90035', '90036', '90037', '90038', '90039', '90040', '90041', '90042', '90043', '90044', '90045', '90046', '90047', '90048', '90049', '90056', '90057', '90058', '90059', '90061', '90062', '90063', '90064', '90065', '90066', '90067', '90068', '90069', '90071', '90073', '90074', '90077', '90089', '90091', '90093', '90094', '90095', '90098', '90099', '90189', '90191', '90210', '90211', '90212', '90220', '90221', '90222', '90230', '90232', '90240', '90241', '90242', '90245', '90247', '90248', '90249', '90250', '90255', '90260', '90262', '90263', '90265', '90266', '90270', '90272', '90274', '90275', '90277', '90278', '90280', '90291', '90292', '90293', '90294', '90295', '90301', '90302', '90303', '90304', '90305', '90306', '90307', '90309', '90310', '90311', '90312', '90313', '90401', '90402', '90403', '90404', '90405', '90406', '90407', '90408', '90409', '90410', '90411'],
            '20000000-aaaa-bbbb-cccc-000000000083' => ['92602', '92603', '92604', '92605', '92606', '92612', '92614', '92615', '92616', '92617', '92618', '92620', '92625', '92626', '92627', '92629', '92630', '92637', '92646', '92647', '92648', '92649', '92650', '92651', '92653', '92655', '92656', '92660', '92661', '92662', '92663', '92672', '92673', '92675', '92676', '92677', '92678', '92679', '92683', '92684', '92691', '92692', '92693', '92694', '92697', '92698', '92701', '92703', '92704', '92705', '92706', '92707', '92708', '92780', '92781', '92782', '92799'],
            '20000000-aaaa-bbbb-cccc-000000000084' => ['92501', '92503', '92504', '92505', '92506', '92507', '92508', '92509', '92516', '92517', '92518', '92519', '92521', '92522', '92530', '92532', '92536', '92539', '92543', '92544', '92545', '92546', '92548', '92551', '92553', '92555', '92557', '92561', '92562', '92563', '92567', '92570', '92571', '92572', '92581', '92582', '92583', '92584', '92585', '92586', '92587', '92590', '92591', '92592', '92593', '92595', '92596', '92599'],
            '20000000-aaaa-bbbb-cccc-000000000085' => ['93001', '93003', '93004', '93010', '93012', '93015', '93021'],

            // WASHINGTON DC
            '20000000-aaaa-bbbb-cccc-000000000086' => ['20001', '20002', '20003', '20004', '20005', '20006', '20007', '20008', '20009', '20010', '20011', '20012', '20015', '20016', '20017', '20018', '20019', '20020', '20024', '20032', '20036', '20037', '20052', '20057', '20059', '20064', '20065', '20066', '20067', '20068', '20072', '20073', '20076', '20090', '20095', '20097', '20098', '20099'],
            '20000000-aaaa-bbbb-cccc-000000000087' => ['20812', '20814', '20815', '20816', '20817', '20818', '20824', '20825', '20826', '20827', '20828', '20829', '20830', '20832', '20833', '20834', '20835', '20836', '20837', '20838', '20839', '20841', '20842', '20843', '20844', '20845', '20846', '20847', '20848', '20849', '20850', '20851', '20852', '20853', '20854', '20855', '20857', '20859', '20860', '20861', '20862', '20863', '20864', '20866', '20867', '20868', '20869', '20871', '20872', '20874', '20875', '20876', '20877', '20878', '20879', '20880', '20882', '20883', '20884', '20885', '20886', '20889', '20891', '20892', '20894', '20895', '20896', '20897', '20898', '20899'],
            '20000000-aaaa-bbbb-cccc-000000000088' => ['20706', '20707', '20708', '20710', '20712', '20715', '20716', '20720', '20721', '20722', '20723', '20724', '20725', '20726', '20731', '20735', '20737', '20740', '20741', '20742', '20743', '20744', '20745', '20746', '20747', '20748', '20749', '20750', '20751', '20752', '20755', '20757', '20759', '20762', '20764', '20765', '20768', '20769', '20770', '20771', '20772', '20774', '20776', '20777', '20778', '20779', '20781', '20782', '20783', '20784', '20785', '20787', '20788', '20790', '20791', '20792', '20794', '20797', '20799'],
            '20000000-aaaa-bbbb-cccc-000000000089' => ['20701', '20703', '20704', '20705', '20706', '20707', '20708', '20709', '20710', '20711', '20712', '20714', '20715', '20716', '20717', '20718', '20719', '20720', '20721', '20722', '20723', '20724', '20725', '20726', '20727', '20728', '20729', '20730', '20731', '20732', '20733', '20734', '20735', '20736', '20737', '20738', '20739', '20740', '20741', '20742', '20743', '20744', '20745', '20746', '20747', '20748', '20749', '20750', '20751', '20752', '20753', '20754', '20755', '20756', '20757', '20758', '20759', '20760', '20761', '20762', '20763', '20764', '20765', '20766', '20767', '20768', '20769', '20770', '20771', '20772', '20773', '20774', '20775', '20776', '20777', '20778', '20779', '20780', '20781', '20782', '20783', '20784', '20785', '20786', '20787', '20788', '20789', '20790', '20791', '20792', '20793', '20794', '20795', '20796', '20797', '20798', '20799'],
            '20000000-aaaa-bbbb-cccc-000000000090' => ['21012', '21032', '21035', '21037', '21039', '21043', '21044', '21045', '21046', '21047', '21048', '21050', '21051', '21052', '21054', '21056', '21057', '21060', '21061', '21062', '21075', '21076', '21077', '21078', '21079', '21080', '21081', '21082', '21084', '21085', '21087', '21090', '21092', '21093', '21095', '21096', '21097', '21098', '21106', '21108', '21113', '21114', '21117', '21122', '21123', '21144', '21146', '21150', '21152', '21156', '21157', '21160', '21162', '21163', '21164', '21168', '21171', '21174', '21175', '21178', '21180', '21186', '21190', '21192', '21193', '21194', '21197', '21199'],
            '20000000-aaaa-bbbb-cccc-000000000091' => ['20601', '20602', '20603', '20604', '20606', '20607', '20608', '20610', '20611', '20612', '20613', '20614', '20615', '20616', '20617', '20618', '20619', '20620', '20622', '20623', '20624', '20625', '20626', '20627', '20628', '20629', '20630', '20632', '20634', '20635', '20637', '20639', '20640', '20641', '20642', '20643', '20646', '20650', '20653', '20656', '20657', '20658', '20659', '20660', '20661', '20662', '20664', '20667', '20670', '20674', '20675', '20676', '20677', '20678', '20679', '20680', '20683', '20684', '20685', '20686', '20687', '20688', '20690', '20692', '20695', '20697'],
            '20000000-aaaa-bbbb-cccc-000000000092' => ['22201', '22202', '22203', '22204', '22205', '22206', '22207', '22209', '22211', '22213', '22214'],
            '20000000-aaaa-bbbb-cccc-000000000093' => ['20120', '20121', '20124', '20151', '20152', '20170', '20171', '20190', '20191', '20192', '20194', '22003', '22015', '22027', '22030', '22031', '22032', '22033', '22039', '22041', '22042', '22043', '22044', '22060', '22066', '22079', '22101', '22102', '22124', '22150', '22151', '22152', '22153', '22180', '22181', '22182', '22191', '22192', '22199', '22306', '22307', '22308', '22309', '22310', '22312', '22315'],
            '20000000-aaaa-bbbb-cccc-000000000094' => ['20105', '20117', '20129', '20132', '20135', '20141', '20147', '20148', '20152', '20158', '20164', '20165', '20166', '20175', '20176', '20180', '20197'],
            '20000000-aaaa-bbbb-cccc-000000000095' => ['22301', '22302', '22304', '22305', '22311', '22312', '22314', '22315'],
            '20000000-aaaa-bbbb-cccc-000000000096' => ['22041', '22042', '22043', '22044'],

            // CHICAGO
            '20000000-aaaa-bbbb-cccc-000000000097' => ['60601', '60602', '60603', '60604', '60605', '60606', '60607', '60608', '60609', '60610', '60611', '60612', '60613', '60614', '60615', '60616', '60617', '60618', '60619', '60620', '60621', '60622', '60623', '60624', '60625', '60626', '60628', '60629', '60630', '60631', '60632', '60633', '60634', '60636', '60637', '60638', '60639', '60640', '60641', '60642', '60643', '60644', '60645', '60646', '60647', '60649', '60651', '60652', '60653', '60654', '60655', '60656', '60657', '60659', '60660'],
            '20000000-aaaa-bbbb-cccc-000000000098' => ['60004', '60005', '60006', '60008', '60090'],
            '20000000-aaaa-bbbb-cccc-000000000099' => ['60007', '60009'],
            '20000000-aaaa-bbbb-cccc-000000000100' => ['60016', '60017', '60018', '60019'],
            '20000000-aaaa-bbbb-cccc-000000000101' => ['60056', '60005', '60095'],
            '20000000-aaaa-bbbb-cccc-000000000102' => ['60038', '60055', '60067', '60074', '60094', '60095'],
            '20000000-aaaa-bbbb-cccc-000000000103' => ['60159', '60168', '60173', '60193', '60194', '60195', '60196'],
            '20000000-aaaa-bbbb-cccc-000000000104' => ['60181', '60126'],
            '20000000-aaaa-bbbb-cccc-000000000105' => ['60301', '60302', '60303', '60304'],
            '20000000-aaaa-bbbb-cccc-000000000106' => ['60804', '60623', '60650'],
            '20000000-aaaa-bbbb-cccc-000000000107' => ['60101', '60103', '60105', '60106', '60108', '60116', '60117', '60120', '60126', '60128', '60137', '60138', '60139', '60143', '60148', '60157', '60172', '60181', '60185', '60187', '60188', '60189', '60190', '60502', '60515', '60516', '60517', '60521', '60523', '60527', '60532', '60540', '60559', '60561', '60563', '60564', '60565', '60566', '60569', '60572', '60585'],
            '20000000-aaaa-bbbb-cccc-000000000108' => ['60002', '60010', '60011', '60012', '60013', '60015', '60020', '60021', '60030', '60031', '60035', '60037', '60040', '60041', '60042', '60044', '60045', '60046', '60047', '60048', '60060', '60061', '60064', '60069', '60073', '60075', '60079', '60083', '60084', '60085', '60087', '60088', '60096', '60099'],
            '20000000-aaaa-bbbb-cccc-000000000109' => ['60401', '60403', '60404', '60408', '60410', '60416', '60417', '60421', '60423', '60431', '60432', '60433', '60434', '60435', '60436', '60439', '60440', '60441', '60442', '60446', '60448', '60449', '60451', '60466', '60467', '60468', '60471', '60475', '60477', '60481', '60487', '60490', '60491', '60544', '60561', '60564', '60565', '60585', '60586'],
            '20000000-aaaa-bbbb-cccc-000000000110' => ['60538', '60541', '60543', '60545', '60548', '60560'],
            '20000000-aaaa-bbbb-cccc-000000000111' => ['60012', '60013', '60033', '60034', '60050', '60051', '60071', '60072', '60081', '60097', '60098'],
            '20000000-aaaa-bbbb-cccc-000000000112' => ['60109', '60110', '60118', '60120', '60123', '60134', '60136', '60140', '60142', '60144', '60147', '60151', '60174', '60175', '60177', '60183', '60505', '60506', '60510', '60511', '60519', '60539', '60542'],
            '20000000-aaaa-bbbb-cccc-000000000113' => ['60407', '60416', '60424', '60437', '60444', '60450', '60474', '60481', '61360'],
            '20000000-aaaa-bbbb-cccc-000000000114' => ['60111', '60112', '60115', '60119', '60129', '60135', '60145', '60146', '60150', '60151', '60178'],
            '20000000-aaaa-bbbb-cccc-000000000115' => ['60401', '60410', '60411', '60421', '60422', '60468', '60474', '60901', '60910', '60914', '60915', '60917', '60922', '60935', '60940', '60941', '60944', '60950', '60954', '60958', '60961', '60964'],

            // NASHVILLE
            '20000000-aaaa-bbbb-cccc-000000000116' => ['37011', '37013', '37024', '37027', '37070', '37072', '37076', '37080', '37086', '37115', '37116', '37135', '37138', '37143', '37189', '37201', '37202', '37203', '37204', '37205', '37206', '37207', '37208', '37209', '37210', '37211', '37212', '37213', '37214', '37215', '37216', '37217', '37218', '37219', '37220', '37221', '37222', '37224', '37227', '37228', '37229', '37230', '37232', '37234', '37235', '37236', '37237', '37238', '37240', '37241', '37242', '37243', '37244', '37245', '37246', '37247', '37248', '37249', '37250'],
            '20000000-aaaa-bbbb-cccc-000000000117' => ['37014', '37024', '37027', '37046', '37062', '37064', '37065', '37067', '37068', '37069', '37135', '37174', '37179', '38476'],
            '20000000-aaaa-bbbb-cccc-000000000118' => ['37014', '37020', '37037', '37060', '37063', '37085', '37086', '37089', '37118', '37127', '37128', '37129', '37130', '37131', '37132', '37133', '37149', '37153', '37167'],
            '20000000-aaaa-bbbb-cccc-000000000119' => ['37012', '37016', '37020', '37022', '37087', '37090', '37110', '37122', '37184'],
            '20000000-aaaa-bbbb-cccc-000000000120' => ['37011', '37066', '37075', '37148', '37160', '37188'],
            '20000000-aaaa-bbbb-cccc-000000000121' => ['37015', '37029', '37035', '37062', '37082', '37141', '37146', '37165'],
            '20000000-aaaa-bbbb-cccc-000000000122' => ['37010', '37032', '37049', '37073', '37172', '37186'],
            '20000000-aaaa-bbbb-cccc-000000000123' => ['37025', '37036', '37051', '37055', '37056', '37078', '37134', '37140', '37178', '37181', '37187'],
            '20000000-aaaa-bbbb-cccc-000000000124' => ['37018', '37034', '37047', '37091', '37175', '37179', '38401'],
            '20000000-aaaa-bbbb-cccc-000000000125' => ['37030', '37048'],
        ];

        // ZipCodes por nombre de ciudad
        $zipsByName = [
            'Westchester County' => ['10501', '10502', '10503', '10504', '10505', '10506', '10507', '10510', '10511', '10514', '10517', '10518', '10519', '10520', '10522', '10523', '10526', '10527', '10528', '10530', '10532', '10533', '10535', '10536', '10538', '10543', '10545', '10546', '10547', '10548', '10549', '10550', '10551', '10552', '10553', '10562', '10566', '10567', '10570', '10573', '10576', '10577', '10580', '10583', '10587', '10588', '10589', '10590', '10591', '10594', '10595', '10596', '10597', '10598', '10601', '10603', '10604', '10605', '10606', '10607'],
            'Putnam County' => ['10509', '10512', '10516', '10524', '10537', '10541', '10542', '10579', '10588', '10598'],
            'Dutchess County' => ['12501', '12506', '12507', '12508', '12510', '12512', '12514', '12522', '12524', '12527', '12531', '12533', '12537', '12538', '12540', '12545', '12546', '12564', '12567', '12569', '12570', '12571', '12572', '12574', '12578', '12580', '12581', '12582', '12583', '12585', '12590', '12592', '12594', '12601', '12603'],
            'Nassau County' => ['11001', '11003', '11004', '11005', '11010', '11020', '11021', '11023', '11024', '11030', '11040', '11042', '11050', '11501', '11507', '11509', '11510', '11514', '11516', '11518', '11520', '11530', '11542', '11545', '11547', '11548', '11550', '11552', '11553', '11554', '11556', '11557', '11558', '11559', '11560', '11561', '11563', '11565', '11566', '11568', '11570', '11572', '11575', '11576', '11577', '11579', '11580', '11581', '11590', '11596', '11598', '11701', '11710', '11714', '11732', '11735', '11736', '11737', '11753', '11756', '11758', '11762', '11765', '11771', '11783', '11791', '11793', '11797'],
            'Suffolk County' => ['00501', '11701', '11702', '11703', '11704', '11705', '11706', '11707', '11708', '11713', '11715', '11716', '11717', '11718', '11719', '11720', '11721', '11722', '11724', '11725', '11726', '11727', '11729', '11730', '11731', '11733', '11735', '11738', '11739', '11740', '11741', '11742', '11743', '11746', '11747', '11749', '11750', '11751', '11752', '11754', '11755', '11757', '11760', '11763', '11764', '11766', '11767', '11768', '11769', '11770', '11772', '11775', '11776', '11777', '11778', '11779', '11780', '11782', '11784', '11786', '11787', '11788', '11789', '11790', '11792', '11794', '11795', '11796', '11798', '11803', '11804', '11901', '11930', '11931', '11932', '11933', '11934', '11935', '11937', '11939', '11940', '11941', '11942', '11944', '11946', '11947', '11948', '11949', '11950', '11951', '11952', '11953', '11954', '11955', '11956', '11957', '11958', '11959', '11960', '11961', '11962', '11963', '11964', '11965', '11967', '11968', '11970', '11971', '11972', '11973', '11975', '11976', '11977', '11978', '11980'],
            'Los Angeles County' => ['90001', '90002', '90003', '90004', '90005', '90006', '90007', '90008', '90010', '90011', '90012', '90013', '90014', '90015', '90016', '90017', '90018', '90019', '90020', '90021', '90023', '90024', '90025', '90026', '90027', '90028', '90029', '90031', '90032', '90033', '90034', '90035', '90036', '90037', '90038', '90039', '90040', '90041', '90042', '90043', '90044', '90045', '90046', '90047', '90048', '90049', '90056', '90057', '90058', '90059', '90061', '90062', '90063', '90064', '90065', '90066', '90067', '90068', '90069', '90071', '90073', '90074', '90077', '90089', '90091', '90093', '90094', '90095', '90098', '90099', '90189', '90191', '90210', '90211', '90212', '90220', '90221', '90222', '90230', '90232', '90240', '90241', '90242', '90245', '90247', '90248', '90249', '90250', '90255', '90260', '90262', '90263', '90265', '90266', '90270', '90272', '90274', '90275', '90277', '90278', '90280', '90291', '90292', '90293', '90294', '90295', '90301', '90302', '90303', '90304', '90305', '90306', '90307', '90309', '90310', '90311', '90312', '90313', '90401', '90402', '90403', '90404', '90405', '90406', '90407', '90408', '90409', '90410', '90411'],
            'Orange County CA' => ['92602', '92603', '92604', '92605', '92606', '92612', '92614', '92615', '92616', '92617', '92618', '92620', '92625', '92626', '92627', '92629', '92630', '92637', '92646', '92647', '92648', '92649', '92650', '92651', '92653', '92655', '92656', '92660', '92661', '92662', '92663', '92672', '92673', '92675', '92676', '92677', '92678', '92679', '92683', '92684', '92691', '92692', '92693', '92694', '92697', '92698', '92701', '92703', '92704', '92705', '92706', '92707', '92708', '92780', '92781', '92782', '92799'],
            'Riverside County' => ['92501', '92503', '92504', '92505', '92506', '92507', '92508', '92509', '92516', '92517', '92518', '92519', '92521', '92522', '92530', '92532', '92536', '92539', '92543', '92544', '92545', '92546', '92548', '92551', '92553', '92555', '92557', '92561', '92562', '92563', '92567', '92570', '92571', '92572', '92581', '92582', '92583', '92584', '92585', '92586', '92587', '92590', '92591', '92592', '92593', '92595', '92596', '92599'],
            'Ventura County' => ['93001', '93003', '93004', '93010', '93012', '93015', '93021'],
            'DuPage County' => ['60101', '60103', '60105', '60106', '60108', '60116', '60117', '60120', '60126', '60128', '60137', '60138', '60139', '60143', '60148', '60157', '60172', '60181', '60185', '60187', '60188', '60189', '60190', '60502', '60515', '60516', '60517', '60521', '60523', '60527', '60532', '60540', '60559', '60561', '60563', '60564', '60565', '60566', '60569', '60572', '60585'],
            'Lake County IL' => ['60002', '60010', '60011', '60012', '60013', '60015', '60020', '60021', '60030', '60031', '60035', '60037', '60040', '60041', '60042', '60044', '60045', '60046', '60047', '60048', '60060', '60061', '60064', '60069', '60073', '60075', '60079', '60083', '60084', '60085', '60087', '60088', '60096', '60099'],
            'Montgomery County TN' => ['37010', '37015', '37040', '37042', '37043', '37044', '37050', '37052', '37058', '37142', '37171', '37191'],
            'Rockland County' => ['10901', '10911', '10913', '10920', '10923', '10927', '10931', '10952', '10954', '10956', '10960', '10962', '10964', '10965', '10968', '10970', '10974', '10976', '10977', '10980', '10983', '10984', '10986', '10989', '10993', '10994'],
            'Rutherford County' => ['37013'],
            'Sumner County' => ['37031', '37048', '37072', '37080', '37172', '37184', '37186', '37189'],
            'Wilson County' => ['37024', '37077', '37138'],
            'Cheatham County' => ['37181', '37187'],
            'Dickson County' => ['37015', '37029', '37033', '37050', '37062', '37098', '37101', '37135', '37137', '37165', '37221'],
            'Robertson County' => ['37141', '37148', '37171', '37188'],
            'Maury County' => ['37014', '37033', '37046', '37064', '37067', '37069', '37110', '37135', '37160', '37174', '38451', '38453', '38461', '38463', '38469', '38471', '38474', '38476', '38482', '38483', '38485', '38486', '38487'],
        ];

        $inserted = 0;

        // Insertar por city_id fijo
        foreach ($zipsByFixedId as $cityId => $codes) {
            try {
                // Verificar que la ciudad exista
                if (!$this->recordExists('cities', ['id' => $cityId])) {
                    continue;
                }

                foreach ($codes as $code) {
                    try {
                        // Verificar si el zipcode ya existe
                        if ($this->recordExists('zipcodes', ['city_id' => $cityId, 'zipcode' => $code])) {
                            $this->skipped++;
                            continue;
                        }

                        $zipRecord = [
                            'id' => Uuid::uuid4()->toString(),
                            'city_id' => $cityId,
                            'zipcode' => $code,
                            'is_active' => true,
                            'created_at' => date('Y-m-d H:i:s'),
                        ];

                        if ($this->safeInsert('zipcodes', $zipRecord, "zipcode {$code}")) {
                            $inserted++;
                        }
                    } catch (\Exception $e) {
                        $this->errors++;
                        continue;
                    }
                }
            } catch (\Exception $e) {
                $this->errors++;
                continue;
            }
        }

        // Insertar por nombre de ciudad
        foreach ($zipsByName as $cityName => $codes) {
            try {
                // Buscar la ciudad por nombre
                $city = $this->db->table('cities')->where('name', $cityName)->get()->getRow();
                if (!$city) {
                    continue;
                }

                foreach ($codes as $code) {
                    try {
                        // Verificar si el zipcode ya existe
                        if ($this->recordExists('zipcodes', ['city_id' => $city->id, 'zipcode' => $code])) {
                            $this->skipped++;
                            continue;
                        }

                        $zipRecord = [
                            'id' => Uuid::uuid4()->toString(),
                            'city_id' => $city->id,
                            'zipcode' => $code,
                            'created_at' => date('Y-m-d H:i:s'),
                            'updated_at' => date('Y-m-d H:i:s'),
                        ];

                        if ($this->safeInsert('zipcodes', $zipRecord, "zipcode {$code}")) {
                            $inserted++;
                        }
                    } catch (\Exception $e) {
                        $this->errors++;
                        continue;
                    }
                }
            } catch (\Exception $e) {
                $this->errors++;
                continue;
            }
        }

        return $inserted;
    }
}
